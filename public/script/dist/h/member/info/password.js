define("h/member/info/password",["../../public/list.regexp","../../public/tipFun","../../plugins/dialog"],function(t,s,e){function a(t){o.open({title:"错误提醒",content:t,btn:["确定"]})}var n=t("../../public/list.regexp"),i=t("../../public/tipFun"),o=t("../../plugins/dialog"),d=($("#formPwd"),$("#oldPwd")),l=$("#newPwd"),c=$("#confirmPwd"),r=$("#submitBtn"),u=parseInt($("#needOldPwd").val(),10),p=u?"新":"",f={old_password:function(){var t=d.val(),s={obj:d,status:!0,msg:""};return t?t.length<6&&(s.status=!1,s.msg="密码至少6位以上"):(s.status=!1,s.msg="请输入旧密码"),s},new_password:function(){var t=l.val(),s={obj:l,status:!0,msg:""};return t?t==d.val()?(s.status=!1,s.msg=p+"密码不能与旧密码一致"):t.length<6?(s.status=!1,s.msg=p+"密码至少6位以上"):n.hasSpace.test(t)?(s.status=!1,s.msg=p+"密码不能有空格"):n.allNumber.test(t)?(s.status=!1,s.msg=p+"密码不能为纯数字"):n.allLetterSame.test(t)?(s.status=!1,s.msg=p+"密码不能为相同的字母组成"):n.password.test(t)||(s.status=!1,s.msg=p+"密码只能由英文、数字及符号组成"):(s.status=!1,s.msg="请输入"+p+"密码"),s},confirm_password:function(){var t=l.val(),s=c.val(),e={obj:c,status:!0,msg:""};return s?t!=s&&(e.status=!1,e.msg="两次输入的密码不一致，请重新输入"):(e.status=!1,e.msg="请再次输入"+p+"密码"),e}},v=function(t){var s=f[t]();return s.status||a(s.msg),s};r.on("click",function(){var t=!0,s=["old_password","new_password","confirm_password"],e={oldpwd:d.val(),newpwd:l.val()};u||(s.shift(),delete e.old_password);for(var n in s)if(!v(s[n]).status)return t=!1;return t&&$.ajax({url:"/member/api/chpassword/",type:"POST",dataType:"json",beforeSend:function(){r.attr("disabled",!0)},data:e}).done(function(t){t.status?i.fire("success",t.errmsg,function(){window.location.href="/member/info/"}):(t.errmsg&&a(t.errmsg),r.attr("disabled",!1))}).fail(function(){r.attr("disabled",!1)}),!1})}),define("h/public/list.regexp",[],{email:/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,code:/^\d{4}$/,zipcode:/^[0-9]{6}$/,mobilephone:/^1[3-9][0-9]{9}$/,areacode:/^\d{3,6}$/,tel:/^\d{7,8}$/,ext:/\d{3,}$/,captcha:/^\w{4}$/,username:/^[a-zA-Z][a-zA-Z0-9_\-]*$/,password:/^[a-zA-Z0-9_!@#\$%\^&\*\(\)\\\|\/\?\.\<\>'"\{\}\[\]=\-\+\~\,\;\:\s]+$/,chinese:/^[\u4e00-\u9fa5]+$/,link:/^(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;\+#]*[\w\-\@?^=%&amp;\+#])?/,qq:/^[1-9][0-9]{4,}$/,regPrice:/^[0-9]+([.]{1}[0-9]{1,2})?$/,positiveNum:/^[1-9]\d*$/,allNumber:/^\d+$/,allLetter:/^[a-zA-Z]+$/,symbols:/[_!@#\$%\^&\*\(\)\\\|\/\?\.\<\>'"\{\}\[\]=\-\+\~\,\;\:\s]+/,allSame:/^([\s\S])\1*$/,allLetterSame:/^([a-zA-Z])\1*$/,lowerLetter:/[a-z]+/,upperLetter:/[A-Z]+/,hasSpace:/\s/}),define("h/public/tipFun",[],function(t,s,e){s.fire=function(t,s,e,a){$.isFunction(e)?(a=e,e=2e3):(e=e||2e3,a=a||function(){});var n=$("#tipBox");n[0]&&n.remove();var i='<div id="tipBox" class="mod-tip-box"><div class="tip-box-inner"><div class="tip-box-content"><span class="icon '+t+'"></span><span class="txt">'+s+"</span></div></div></div>";$("body").append(i),$("#tipBox").stop().show().delay(e).fadeOut(500,function(){$(this).remove(),"function"==typeof a&&a()})}}),define("h/plugins/dialog",[],function(t,s,e){function a(t){var s=this;s.config=$.extend({},n,t),s.view()}var n={shade:!0,shadeClose:!1,title:"提示信息",content:"",btn:["确定","取消"]},i={open:function(t){new a(t)},close:function(){var t=$("#"+o[0]);t[0]&&t.remove()}},o=["mod-dialog"];a.prototype.view=function(){i.close();var t=this,s=t.config,e=s.shade?$('<div id="'+o[0]+'" class="'+o[0]+' dialogshade" '+("string"==typeof s.shade?'style="'+s.shade+'"':"")+"></div>"):$('<div id="'+o[0]+'" class="'+o[0]+'"></div>'),a=function(){var t="object"==typeof s.title;return s.title?'<div class="title" style="'+(t?s.title[1]:"")+'">'+(t?s.title[0]:s.title)+"</div>":""}(),n=function(){"string"==typeof s.btn&&(s.btn=[s.btn]);var t=s.btn.length,e="";return 0!==t&&s.btn?(e='<a class="yes" type="1" href="javascript:;">'+s.btn[0]+"</a>",2===t&&(e='<a class="cancel" type="0" href="javascript:;">'+s.btn[1]+"</a>"+e),'<div class="btns">'+e+"</div>"):""}(),d='<div class="dialog-inner"><div class="dialog-main">'+a+'<div class="disc">'+s.content+"</div>"+n+"</div></div>";e.html(d),$("body").append(e);var l=$("#"+o[0]);s.success&&s.success(),t.action(s,l)},a.prototype.action=function(t,s){function e(){t.cancel&&t.cancel(),i.close()}t.shade&&t.shadeClose&&s.on("click",function(t){"mod-dialog"==t.target.id&&i.close()}),s.on("touchmove",function(t){t.preventDefault()}),s.find(".btns").children("a").on("click",function(){var s=$(this).attr("type");1==s?t.yes?t.yes():i.close():0==s&&e()})},e.exports=i});