define("h/smallgame/play",["../plugins/cookie"],function(e,t,i){$(function(){!function(e){var t=function(){var e=$(window).width(),t=$(window).height();t-$("#framenav").outerHeight(!0);$("#myIframe").width(e).height(t),$("#assistiveTouch").css({right:"0px",top:"140px",left:"auto"}).find(".pic").removeClass("rotate-child-left")};t(),e.addEventListener("resize",t,!1)}(window),function(){var t=e("../plugins/cookie"),i=$("#assistiveTouch"),n=$("#sidebar"),o=navigator.userAgent.toLowerCase(),r=o.indexOf("youlaohu")>-1;window.manyouSidebar={init:function(){this.registerAssistiveMove(),this.touchCartoonTrigger(),this.touchScroll("#sidebar",".scrollable"),i.show(),i.on("click",function(e){i.find(".tip").hide(),window.manyouSidebar.show()}),n.on("click",function(e){"modal"==e.target.className&&window.manyouSidebar.hide()}),setTimeout(function(){$("#shadeLoad").hide()},2e3),r||$("#myIframe").load(function(){t.get("exit_game_time")?t.get("exit_game_time")!=(new Date).getDay()&&window.manyouSidebar.exitGame():window.manyouSidebar.exitGame()})},show:function(){window.manyouSidebar.registerPanelControl(),n.fadeIn(200),n.find(".modal-dialog").animate({"margin-left":"0px"},200,function(){})},hide:function(){n.fadeOut(200),n.find(".modal-dialog").animate({"margin-left":"-84%"},200)},registerAssistiveMove:function(){var e=this,t=i.outerWidth(!0),n=i.outerHeight(!0);i.on({touchstart:function(t){e.keepSide&&clearTimeout(e.keepSide),i.stop(),i.removeClass("touch-side").find(".pic").removeClass("rotate-child-left");var n=t.originalEvent.targetTouches[0];touchStartX=n.clientX,touchStartY=n.clientY;var o=i.offset();assistiveTouchOriginX=o.left,assistiveTouchOriginY=o.top},touchmove:function(e){var o=$(window).width(),r=$(window).height(),a=e.originalEvent.targetTouches[0],s=a.clientX-touchStartX,c=a.clientY-touchStartY,l=assistiveTouchOriginX+s>0?assistiveTouchOriginX+s:0,d=assistiveTouchOriginY+c>0?assistiveTouchOriginY+c:0;l=l+t>o?o-t:l,d=d+n>r?r-n:d,i.offset({left:l,top:d});var u=(l+t/2)/o;.5>=u?i.find(".tip").addClass("tip-left"):i.find(".tip").removeClass("tip-left"),e.preventDefault()},touchend:function(n){var o=$(window).width(),r=i.offset(),a=r.left,s=(a+t/2)/o,c=.5>=s?0:o-t;i.css("left",i.offset().left).animate({left:c},200),e.touchCartoonTrigger()}})},touchCartoonTrigger:function(){var e=this,t=i.outerWidth(!0),n=$(window).width(),o=function(){var e=i.offset(),o=e.left,r=e.top;i.offset({left:o,top:r});var a=(o+t/2)/n,s=.5>=a?"-="+(t-28)+"px":"+="+(t-28)+"px";i.animate({left:s},200,function(){.5>=a?i.css({left:0}).addClass("touch-side").find(".pic").addClass("rotate-child-left"):i.addClass("touch-side")})};e.keepSide=setTimeout(o,2e3)},registerPanelControl:function(){function e(e){window.manyouSidebar.hide(),t.showRewardFrame(e.attr("data-src")),n.show()}var t=this,i=$("#codeBox"),n=$("#framenav");$("#saveGame").on("click",function(){i.show()}),i.on({click:function(e){var t=e.target.className;("code-box-wrap"==t||"close"==t)&&(window.manyouSidebar.hide(),i.hide())},touchmove:function(e){e.preventDefault()}}),$("#sign").on("click",function(){return e($(this)),!1}),n.on("click",".return",function(){return t.removeRewardFrame(),!1})},touchScroll:function(e,t){var t=document.querySelector(e+" "+t);t.addEventListener("touchstart",function(){var e=t.scrollTop,i=t.scrollHeight,n=e+t.offsetHeight;0===e?t.scrollTop=1:n===i&&(t.scrollTop=e-1)}),t.addEventListener("touchmove",function(e){t.offsetHeight<t.scrollHeight&&(e._isScroller=!0)}),document.querySelector(e).addEventListener("touchmove",function(e){e._isScroller||e.preventDefault()})},showRewardFrame:function(e){var t=document.getElementById("rewardFrameWrap");t&&document.body.removeChild(t);var i=$(window).height()-$("#framenav").outerHeight(!0),t=document.createElement("div");t.className="frame-wrap",t.id="rewardFrameWrap",t.style.margin="auto",t.style.minWidth="320px",t.style.width="100%",t.style.height=i+"px";var n=document.createElement("iframe");n.id="rewardFrame",n.className="reward-frame",n.style.minWidth="320px",n.style.display="block",n.style.verticalAlign="bottom",n.style.width="100%",n.style.height=i+"px",n.style.margin=0,n.style.padding=0,n.setAttribute("frameborder","0"),n.setAttribute("border","0"),n.setAttribute("marginwidth","0"),n.setAttribute("marginheight","0"),n.setAttribute("scrolling","auto"),n.src=e,document.body.appendChild(t),t.appendChild(n)},removeRewardFrame:function(){var e=document.getElementById("rewardFrameWrap");e&&document.body.removeChild(e),$("#framenav").hide()},exitGame:function(){var e=this,i=$("#exitGameBox"),n=!0;i.on("touchmove",function(e){e.preventDefault()}),i.on("click",".close, .btn-keep",function(){$(this);return i.hide(),window.history.pushState({title:document.title,url:location.href},document.title,location.href),!1}),i.on("click",".btn-leave",function(){return console.log("referrer:",document.referrer),""===document.referrer&&o.indexOf("micromessenger")>-1?wx.closeWindow():window.history.back(),!1}),i.on("click",".checkbox",function(){var i=$(this);return n?(i.addClass("checkbox-on"),t.set("exit_game_time",(new Date).getDay(),{timeFormat:"hs",expires:8760,path:"/"}),window.removeEventListener("popstate",function(){})):(i.removeClass("checkbox-on"),t.remove("exit_game_time",{path:"/"}),e.exitGameAddEvent()),n=!n,!1}),e.exitGameAddEvent()},exitGameAddEvent:function(){setTimeout(function(){"pushState"in window.history&&(window.history.pushState({title:document.title,url:location.href},document.title,location.href),window.addEventListener&&window.addEventListener("popstate",function(e){if(console.log("popstate event:",e.state),!e.state){var t=$("#exitGameBox");t.find("img").each(function(){var e=$(this);e.attr("src",e.data("src"))}),t.fadeIn(500)}}))},2e3)}},manyouSidebar.init()}(),function(){var e={title:"游老虎"+$("#gameName").val(),desc:"无需下载，打开即玩！",link:window.location.href,imgUrl:$("#shareImgUrl").val()||PageConfig.imgUrl+"h/public/logo.png"};wx.ready(function(){wx.checkJsApi({jsApiList:["chooseWXPay","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone"],success:function(e){console.log(e)}}),wx.onMenuShareTimeline({title:"游老虎"+$("#gameName").val()+"，无需下载，打开即玩！",link:e.link,imgUrl:e.imgUrl,success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){},cancel:function(){}}),wx.onMenuShareQQ({title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){},cancel:function(){}}),wx.onMenuShareWeibo({title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){},cancel:function(){}}),wx.onMenuShareQZone({title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){},cancel:function(){}})})}()})}),define("h/plugins/cookie",[],function(e,t,i){i.exports={docu:window.document,set:function(e,t,i){i=$.extend({},i);var n=new Date;return"number"==typeof i.expires&&(i.timeFormat?"hs"===i.timeFormat&&(n.setDate(n.getDate()+parseInt(i.expires/24)),n.setHours(n.getHours()+i.expires%24)):(n.setMinutes(n.getMinutes()+parseInt(i.expires/60)),n.setSeconds(n.getSeconds()+i.expires%60))),this.docu.cookie=[e,"=",encodeURIComponent(t),i.expires?"; expires="+n.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join(""),this},get:function(e){for(var t,i=this.docu.cookie.split("; "),n=0,o=i.length;o>n;n++)if(t=i[n].split("="),t[0]===e)return decodeURIComponent(t[1]);return""},remove:function(e,t){return this.set(e,"",$.extend({},t,{expires:-1})),this}}});